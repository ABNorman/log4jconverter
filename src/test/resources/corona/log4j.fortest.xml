<?xml version="1.0" encoding="UTF-8"?>
<!--
############################################################################
##
##
##   @(#) Version : [$CommitID$]
##   @(#) Pfad    : [$Source$]
##
############################################################################
##
##
##
##   ****
##   **** Dies ist die log4j Konfigurationsdatei fuer die Test-Ausfuehrung in Jenkins.
##   ****
##
##   Es wird aktiviert mittels -Dlog4j.configuration=log4j.fortest.xml (siehe toplevel pom, surefire-Parameter).
##
##   Hinweise:
##     Die log4j Konfig fuer Eclipse / lokaler Tests befindet sich in der Datei log4j.xml.
##     Die JBoss-Log4j Konfiguration wird ausgeliefert und befindet sich unter de.farnetto.common/release/corona/conf.
##
##
####################################################################### -->
<!DOCTYPE log4j:configuration SYSTEM "log4j.dtd">

   <!-- =====================================================================

        Log4j-Konfiguration

        Dieser Konfigurationsdatei wird benutzt fuer Tests im Daily-Build (Jenkins).

        ==================================================================== -->

<log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/" debug="false">

   <!-- ====================================================================
        Anwendungs-Logdatei fuer corona.
        Default fuer alle Meldungen, die nicht explizit woanders geroutet werden.
        ==================================================================== -->
   <appender name="APPL" class="org.apache.log4j.RollingFileAppender">
      <param name="File" value="${project.build.directory}/logs/appl.class30.log"/>
      <param name="Append" value="true"/>
      <param name="MaxFileSize" value="75MB"/>
      <param name="MaxBackupIndex" value="2"/>
      <layout class="com.farnetto.util.logging.CDPatternLayout">
         <param name="ConversionPattern" value="%G|%5p|%m (%x) [%c{3}]%n"/>
      </layout>
   </appender>

   <!-- ====================================================================
        Console-Logger.
        Alle Meldungen werden hierher geroutet.

        In Jenkins werden die Logmeldungen vom Test angezeigt, wenn die Meldungen auf stdout erscheinen.
        Daher wird hier alles auf der Console ausgegeben.
        ==================================================================== -->
   <appender name="CONSOLE" class="org.apache.log4j.ConsoleAppender">
      <layout class="org.apache.log4j.EnhancedPatternLayout">
         <param name="ConversionPattern" value="%d{ABSOLUTE} %-5p %t %C{1.}::%M:%L %m [%c{1}]%n"/>
      </layout>
   </appender>

   <!-- ====================================================================
        DBQS-Logdatei.
        Wird im Daily-Build benutzt um die Hibernate-queries zu protokollieren.
        -Dvalidate_hibernate_schema=true
        ==================================================================== -->
   <appender name="DBQS" class="org.apache.log4j.FileAppender">
      <param name="File" value="${project.build.directory}/logs/dbqs.class30.log"/>
      <param name="Append" value="false"/>
      <layout class="org.apache.log4j.PatternLayout">
         <param name="ConversionPattern" value="%m%n"/>
      </layout>
   </appender>

   <!-- ====================================================================
        corona Spring-XML-Logdatei.
        Fuer die JUnit-Tests nicht relevant, daher Threshold=OFF.
        ==================================================================== -->
   <appender name="SPRING-XML-APPENDER" class="org.apache.log4j.RollingFileAppender">
      <param name="File" value="${project.build.directory}/logs/spring.class30.log"/>
      <param name="Append" value="false"/>
      <param name="Threshold" value="OFF"/>
      <layout class="org.apache.log4j.PatternLayout">
         <param name="ConversionPattern" value="%m%n"/>
      </layout>
   </appender>
   
   <!-- ====================================================================
        corona JMS-Nachrichten-Logdatei.
        JMS-Nachrichten werden hierher geloggt.
        ==================================================================== -->
   <appender name="JMS" class="org.apache.log4j.RollingFileAppender">
      <param name="File" value="${project.build.directory}/logs/jms.class30.log"/>
      <param name="Append" value="true"/>
      <layout class="com.farnetto.util.logging.CDPatternLayout">
         <param name="ConversionPattern" value="%d{MMM dd HH:mm:ss} %m%n"/>
      </layout>
   </appender>

   <!-- ====================================================================
        Logger-Definitionen.
        Setze die "level" hoeher, um wenige Logging zu haben.
        ==================================================================== -->

   <!-- die FW wird allgemein auf INFO gesetzt, die Anwendung auf DEBUG -->
   <logger name="de.farnetto">
       <level value="INFO"/>
   </logger>
   <logger name="de.farnetto.application">
       <level value="INFO"/>
   </logger>
   <logger name="de.farnetto.domain">
       <level value="INFO"/>
   </logger>
   <!-- useful for deciphering what's going on with the JmsMockSender tests -->
   <logger name="de.farnetto.application.mt.brokerage.cowiasmock">
       <level value="DEBUG"/>
   </logger>
   <logger name="de.farnetto.technology.mt.persistence">
       <level value="INFO"/>
   </logger>
   <!-- startup category -->
   <logger name="STARTUP">
       <level value="INFO"/>
   </logger>

   <!-- ====================================================================
        MDG-Logging (Dies ist getrennt von MDG-Log).
        ==================================================================== -->
   <logger name="com.mdgms">
      <level value="WARN"/>
   </logger>

   <!-- ====================================================================
        Spring-Meldungen.
        ==================================================================== -->
   <logger name="org.springframework">
      <level value="WARN"/>
   </logger>
   <!-- Logging von Spring Transactionmanagement -->
   <logger name="org.springframework.transaction.support">
      <level value="DEBUG"/>
   </logger>
   <!-- Alle Transactionen loggen, die im HibernateTransactionManager entstehen -->
   <logger name="org.springframework.orm.hibernate3.HibernateTransactionManager">
     <level value="DEBUG"/>
   </logger>
   <!-- fuer Hibernate-Validation der ORM-Dateien (-Dvalidate_hibernate_schema=true) -->
   <logger name="de.farnetto.technology.mt.persistence.OrmQueryDumper" additivity="false">
       <level value="DEBUG"/>
       <appender-ref ref="DBQS"/>
   </logger>

   <!-- ====================================================================
        Hibernate-Meldungen.
        ==================================================================== -->
   <logger name="org.hibernate">
      <level value="WARN"/>
   </logger>

   <!-- log hibernate SQL statements -->
   <logger name="org.hibernate.SQL">
     <level value="WARN"/>
   </logger>

   <!-- Log die Werte der gebundenen Variablen bei Prepared-Statements -->
   <logger name="org.hibernate.type">
     <level value="WARN"/>
   </logger>

   <logger name="org.hibernate.hql.ast.QueryTranslatorImpl">
     <level value="WARN"/>
   </logger>

   <logger name="org.hibernate.impl.SessionFactoryImpl">
      <level value="WARN"/>
   </logger>

   <!-- ====================================================================
        Spring-XML-Logging.
        **** Der Level sollte immer auf TRACE stehen. ****
        ==================================================================== -->
   <logger name="SPRING-XML" additivity="false">
      <level value="TRACE"/> <!--  nicht aendern! -->
      <appender-ref ref="SPRING-XML-APPENDER" />
   </logger>

   <!-- ====================================================================
        STDOUT, STDERR werden in die APPL-Logs geroutet.
        ==================================================================== -->
   <logger name="STDOUT" additivity="false">
      <appender-ref ref="APPL"/>
      <appender-ref ref="CONSOLE"/>
   </logger>
   <logger name="STDERR" additivity="false">
      <appender-ref ref="APPL"/>
      <appender-ref ref="CONSOLE"/>
   </logger>

   <!-- ====================================================================
        JMS-Logging.
        ==================================================================== -->
   <logger name="JMS-LOGGER" additivity="false">
      <level value="INFO"/>
      <appender-ref ref="JMS" />
   </logger>
   
   <!-- ====================================================================
        FIXENGINE-Logging.
        ==================================================================== -->
   <logger name="FIXENGINE-LOGGER" additivity="false">
      <level value="INFO"/>
      <appender-ref ref="CONSOLE"/>      
   </logger>

   <!-- ====================================================================
        Konfiguration der Root-Logger.
        Per Default gehen Meldungen ans CONSOLE und der Applikations-Log.
        ==================================================================== -->
   <root>
      <level value="WARN"/>
      <appender-ref ref="CONSOLE"/>
      <appender-ref ref="APPL"/>
   </root>
   

</log4j:configuration>
